{% extends "./base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<!-- ... Código HTML existente ... -->

<section class="trending-product section" style="margin-top: 12px;">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section-title">
                    <h2>Nuevos Productos</h2>
                    <p>There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form.</p>
                </div>
            </div>
        </div>
        <!-- Start Trending Product Area -->
        <div class="col-lg-5 col-md-7 d-xs-none">
            <!-- Start Main Menu Search -->
            <div class="main-menu-search">
                <div class="navbar-search search-style-5">
                    <form method="GET" action="/filtro_libros_nombre/">
                        <input type="text" name="busqueda" placeholder="Buscar libros por nombre">
                        <button type="submit">Buscar</button>
                    </form>
                </div>
            </div>
            {% if buscar %}
                <h2>Resultados de la búsqueda:</h2>
                <ul>
                    {% for libro in buscar %}
                        <li>{{ libro.nombre }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No se encontraron resultados.</p>
            {% endif %}
            <!-- End Main Menu Search -->
        </div>
        <div class="row">
            {% for l in libros %}
                <div class="col-lg-3 col-md-6 col-12">
                    <!-- Start Single Product, index.html -->
                    <div class="single-product">
                        <div class="product-image">
                            {% if l.imagen %}
                                <img src="data:imagen/jpg;base64, {{ l.imagen }}" alt="#">
                            {% else %}
                                <img src="../../static/img/imagen_no_disponible.png" alt="#">
                            {% endif %}
                            <div class="button">
                                <form action="/agregar_al_carrito/" method="post">
                                    {% csrf_token %}
                                    <input type="hidden" name="producto_id" value="{{ l.id }}">
                                    <button class="add-to-cart-btn btn btn-primary" type="submit">
                                        <i class="lni lni-cart"></i> Añadir al carrito
                                    </button>
                                </form>
                            </div>
                        </div>
                        <div class="product-info">
                            <span class="category">{{ l.data.6 }}</span>
                            <h4 class="title">
                                <a href="product-grids.html">{{ l.data.1 }}</a>
                            </h4>
                            <ul class="review">
                                <li><i class="lni lni-star-filled"></i></li>
                                <li><i class="lni lni-star-filled"></i></li>
                                <li><i class="lni lni-star-filled"></i></li>
                                <li><i class="lni lni-star-filled"></i></li>
                                <li><i class="lni lni-star"></i></li>
                                <li><span>4.0 Review(s)</span></li>
                            </ul>
                            <div class="price">
                                <span>$ {{ l.data.3 }}</span>
                            </div>
                        </div>
                    </div>
                    <!-- End Single Product -->
                </div>
            {% endfor %}
        </div>
    </div>
</section>



<!-- ... Código HTML existente ... -->

<!-- End Trending Product Area -->


    <!-- End Trending Product Area -->
    <!-- Start Call Action Area -->
    <section class="call-action section">
        <div class="container">
            <div class="row ">
                <div class="col-lg-8 offset-lg-2 col-12">
                    <div class="inner">
                        <div class="content">
                            <h2 class="wow fadeInUp" data-wow-delay=".4s">Currently You are using free<br>
                                Lite version of ShopGrids</h2>
                            <p class="wow fadeInUp" data-wow-delay=".6s">Please, purchase full version of the template
                                to get all pages,<br> features and commercial license.</p>
                            <div class="button wow fadeInUp" data-wow-delay=".8s">
                                <a href="javascript:void(0)" class="btn">Purchase Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- End Call Action Area -->
    <!-- Start Shipping Info -->
    <section class="shipping-info">
        <div class="container">
            <ul>
                <!-- Free Shipping -->
                <li>
                    <div class="media-icon">
                        <i class="lni lni-delivery"></i>
                    </div>
                    <div class="media-body">
                        <h5>Envío gratis</h5>
                        <span>En pedidos superior a $ 20.000</span>
                    </div>
                </li>
                <!-- Money Return -->
                <li>
                    <div class="media-icon">
                        <i class="lni lni-support"></i>
                    </div>
                    <div class="media-body">
                        <h5>Apoyo 24/7 .</h5>
                        <span>Chat En Vivo o Llamadas.</span>
                    </div>
                </li>
                <!-- Support 24/7 -->
                <li>
                    <div class="media-icon">
                        <i class="lni lni-credit-cards"></i>
                    </div>
                    <div class="media-body">
                        <h5>Pagos Online.</h5>
                        <span>Servicios de pago.</span>
                    </div>
                </li>
                <!-- Safe Payment -->
                <li>
                    <div class="media-icon">
                        <i class="lni lni-reload"></i>
                    </div>
                    <div class="media-body">
                        <h5>Devoluciónes.</h5>
                        <span>Compras sin problemas.</span>
                    </div>
                </li>
            </ul>
        </div>
    </section>
    <!-- End Shipping Info -->

    


    <!-- Start Footer Area -->
    <footer class="footer">
        <!-- Start Footer Top -->
        <div class="footer-top">
            <div class="container">
                <div class="inner-content">
                    <div class="row">
                        <div class="col-lg-3 col-md-4 col-12">
                            <div class="footer-logo">
                                <a href="index.html">
                                    <img src="assets/images/logo/white-logo.svg" alt="#">
                                </a>
                            </div>
                        </div>
                        <div class="col-lg-9 col-md-8 col-12">
                            <div class="footer-newsletter">
                                <h4 class="title">
                                    Suscribete a nuestro boletín de noticias
                                    <span>Obtenga toda la información más reciente en Ventas y Ofertas.</span>
                                </h4>
                                <div class="newsletter-form-head">
                                    <form action="#" method="get" target="_blank" class="newsletter-form">
                                        <input name="EMAIL" placeholder="Dirección de correo electrónico aquí..." type="email">
                                        <div class="button">
                                            <button class="btn">Subscribirse<span class="dir-part"></span></button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Footer Top -->
        <!-- Start Footer Middle -->
        <div class="footer-middle">
            <div class="container">
                <div class="bottom-inner">
                    <div class="row">
                        <div class="col-lg-3 col-md-6 col-12">
                            <!-- Single Widget -->
                            <div class="single-footer f-contact">
                                <h3>Póngase en contacto con nosotros</h3>
                                <p class="phone">Phone: +1 (900) 33 169 7720</p>
                                <ul>
                                    <li><span>Lunes-Viernes: </span> 9.00 am - 8.00 pm</li>
                                    <li><span>Sabados: </span> 10.00 am - 6.00 pm</li>
                                </ul>
                                <p class="mail">
                                    <a href="mailto:support@shopgrids.com">support@libreriaimagina.com</a>
                                </p>
                            </div>
                            <!-- End Single Widget -->
                        </div>
                        <div class="col-lg-3 col-md-6 col-12">
                            <!-- Single Widget -->
                            <div class="single-footer our-app">
                                <h3>Nuestra aplicación móvil</h3>
                                <ul class="app-btn">
                                    <li>
                                        <a href="javascript:void(0)">
                                            <i class="lni lni-apple"></i>
                                            <span class="small-title">Descargalo en</span>
                                            <span class="big-title">App Store</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0)">
                                            <i class="lni lni-play-store"></i>
                                            <span class="small-title">Descargalo en</span>
                                            <span class="big-title">Google Play</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <!-- End Single Widget -->
                        </div>
                        <div class="col-lg-3 col-md-6 col-12">
                            <!-- Single Widget -->
                            <div class="single-footer f-link">
                                <h3>Información</h3>
                                <ul>
                                    <li><a href="javascript:void(0)">Sobre Nosotros</a></li>
                                    <li><a href="javascript:void(0)">Manual De Usuario</a></li>
                                    <li><a href="javascript:void(0)">Mapa Del Sitio</a></li>
                                    <li><a href="javascript:void(0)">Pagina FAQs</a></li>
                                </ul>
                            </div>
                            <!-- End Single Widget -->
                        </div>
                        <div class="col-lg-3 col-md-6 col-12">
                            <!-- Single Widget -->
                            <div class="single-footer f-link">
                                <h3>Shop Departments</h3>
                                <ul>
                                    <li><a href="javascript:void(0)">Computers & Accessories</a></li>
                                    <li><a href="javascript:void(0)">Smartphones & Tablets</a></li>
                                    <li><a href="javascript:void(0)">TV, Video & Audio</a></li>
                                    <li><a href="javascript:void(0)">Cameras, Photo & Video</a></li>
                                    <li><a href="javascript:void(0)">Headphones</a></li>
                                </ul>
                            </div>
                            <!-- End Single Widget -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Footer Middle -->
        <!-- Start Footer Bottom -->
        <div class="footer-bottom">
            <div class="container">
                <div class="inner-content">
                    <div class="row align-items-center">
                        <div class="col-lg-4 col-12">
                            <div class="payment-gateway">
                                <span>We Accept:</span>
                                <img src="assets/images/footer/credit-cards-footer.png" alt="#">
                            </div>
                        </div>
                        <div class="col-lg-4 col-12">
                            <div class="copyright">
                                <p>Diseñado y Desarrollado Por<a href="https://graygrids.com/" rel="nofollow"
                                        target="_blank"></a></p>
                            </div>
                        </div>
                        <div class="col-lg-4 col-12">
                            <ul class="socila">
                                <li>
                                    <span>Siguenos En:</span>
                                </li>
                                <li><a href="javascript:void(0)"><i class="lni lni-facebook-filled"></i></a></li>
                                <li><a href="javascript:void(0)"><i class="lni lni-twitter-original"></i></a></li>
                                <li><a href="javascript:void(0)"><i class="lni lni-instagram"></i></a></li>
                                <li><a href="javascript:void(0)"><i class="lni lni-google"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Footer Bottom -->
        
    </footer>
    <!--/ End Footer Area -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        var addToCartBtns = document.querySelectorAll('.add-to-cart-btn');
        
        addToCartBtns.forEach(function(btn) {
            btn.addEventListener('click', function() {
                var productoId = this.getAttribute('data-producto-id');
                
                var xhr = new XMLHttpRequest();
                xhr.open('POST', 'agregar_al_carrito'.replace('0', productoId));
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.onload = function() {
                    console.log('Producto agregado al carrito');
                    // Actualizar el número de elementos en el carrito si es necesario
                    var itemsCount = document.querySelector('.dropdown-cart-header span');
                    var itemCount = parseInt(itemsCount.textContent);
                    itemsCount.textContent = itemCount + 1;
                };
                xhr.send();
            });
        });
    </script>
    
{% endblock %}